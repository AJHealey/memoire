% Chapter Template

\chapter{Introduction} % Main chapter title

\label{Chapter1} % Change X to a consecutive number; for referencing this chapter elsewhere, use \ref{ChapterX}

\lhead{Chapter 1. \emph{Introduction}} % Change X to a consecutive number; this is for the header on each page - perhaps a shortened title

With nearly 30,000 students and 10,000 staff members (including teachers and researchers), the Catholic University of Louvain (UCL) is the largest French speaking university in Belgium. The university is composed of several campuses based in Brussels, Tournai, Mons, Charleroi and Louvain-la-Neuve, the latter being the widest and the one we focus on throughout this study. On this particular campus, a wireless Internet connection is provided by the university and is available for all the students and staff members for free. More precisely, there is a total of five wireless networks (i.e. five \texttt{VLANs}) available on the Louvain-la-Neuve's campus. Four of them are developed and maintained by the university itself and are reserved either for the students (with the SSID \texttt{"student.UCLouvain"}), for the staff (with the SSID \texttt{"UCLouvain"}), for the visitors (with the SSID \texttt{"visiteurs.UCLouvain"}) or for a limited Internet access in order to consult the UCL's wireless configuration web page or to download required programs for configuration needed on Windows XP and Windows Vista (with the SSID \texttt{"UCLouvain-prive"}). The fifth network with SSID \texttt{"eduroam"} is for education roaming. That last network is a secure, world-wide roaming access service developed for the international research and education community \cite{eduroam1}. Basically it allows any students, researchers and staff members from other universities to get an Internet access within the UCL's campus without being enrolled to the Catholic University of Louvain.

Providing those wireless accesses for such a large community of users and all over the campus is a real struggle for the UCL's SGSI (\textit{Service Général du Système d'Information}) team that is in charge of keeping the wireless networks up and running whatever troubles or problems may happen. Indeed, in order to deliver and ensure, at any time, a quality connectivity with high performances to everyone, it is vital to develop and maintain those networks everyday so that they remain reliable and efficient.
 
In this study we focus on analyzing and implementing a monitoring tool for the wireless network infrastructure of the Louvain-la-Neuve campus that will help the SGSI team identify, in real-time, the possible problems that might occur on that infrastructure, allowing them to react and be able to fix them as quickly as possible.


\section{State of the art}
Here we present the state of the art of network monitoring and performance analysis tools.
First we give an overview of the related work we can find on this subject and then we give some details about the already existing network monitoring tools available on the market and a comparison with the solution we propose on this thesis.

\subsection{Related Work}

\textbf{A Highly Scalable Monitoring Tool}. Machaka \textit{et al.} present in \cite{article1} the development and testing of a highly scalable monitoring tool for a large scale WiFi network in order to ensure optimal performance of that network. In a large scale WiFi network, it is rather difficult to monitor and manage the network without using monitoring tools that don't have any numerical and graphical representation. In this paper, the network the team works on is composed of more than 400 access points and more than 615 gateway devices. Using this testbed, they developed a monitoring tool, by adding some components to an existing one, \texttt{SEQUIN} \cite{sequin} that was developed for \texttt{MPLS}-based network, and they focused on three metrics, usually used in performance evaluation of WiFi networks, uptime and downtime, load average, radio noise and channel. \texttt{SEQUIN} is a Simple Network Management Protocol-based monitoring system that is capable of tracking QoS metrics in near real time. The \texttt{SEQUIN}'s database structure classifies the data as static or dynamic. Static information is composed of system configuration, network element configuration, network topology, and monitoring agent information as dynamic information consists of polled \texttt{SNMP} data and information computed with this data. 

The three monitoring components the team has added to this monitoring tool include a data collection component, a visualization component and a storage and retrieval component. The first component collects performance information for each device connected to the network using \texttt{SNMP} and {Syslog} protocols. All the data collected is stored into the third component. The second component display the performance of the network using Google Maps for the overall graphical performance of the network and Google Charts for a numerical representation of those performances.

In this thesis, we reuse the idea of the static and dynamic information but also the idea of the three monitoring components. Indeed, we collect network performance data using \texttt{SNMP} and \texttt{Syslog} protocols. Those information are then stored into our database and we use Google Charts to display it. The key difference with our application lies in the fact that the we focus on more metrics than the three proposed in this article.


\textbf{A New Mechanism For Network Monitoring and Shielding In Wireless LAN}. Cheng \textit{et al.} present in \cite{article2} a new useful mechanism for wireless monitoring and an implementation of an effective WLAN monitoring and shielding system running on \texttt{Maemo} operating system, a software platform developed by Nokia, named \texttt{Maemo Shield} to monitor wireless network data stream efficiently. The monitoring tool they have implemented analyzes wireless network protocols efficiently and flexibly and displays them graphically. The mechanism they propose in this paper involves fives parts, namely \textit{User}, \textit{User Interface Module}, \textit{Data Buffer Module}, \textit{Protocol Analysis Module} and \textit{Network Module}. The first step of their multi-threaded monitoring and shielding system is to collect all the data from network stream for the monitoring process. For this data gathering process they use, what they call, sniffers. Those devices, of the Network Module, capture packets and observe the traffic characteristics. Once the collection has been made, the data is transfered to the Protocol Analysis Module where packets are analyzed and the results are stored into the Data Buffer Module. Finally, the User Interface Module displays the processed data to User using different ways such as plain text information, histograms, pie charts, grids, and so on.

This simple yet efficient system architecture dividing the work tasks into several modules is reused and developed for our own WLAN monitoring system. Indeed, We also have divided our system in key parts that gather either active and passive raw network data, that store that data, make analysis on them and display to the user via a web user interface. Since we want our application to be efficient and reliable in any situation and network configuration, we also use the multi-threading technology in our implementation design and architecture.


\textbf{From MAP to DIST: The Evolution Of a Large-scale WLAN Monitoring System}. Tan \textit{et al.} present in \citep{article3} the \texttt{DIST} (\textit{Dartmouth Internet Security Testbed}), a large-scale WLAN monitoring system. \texttt{DIST} is one of the largest WLAN monitoring systems that is equipped with several sniffers that cover 210 diverse campus location, 420 radio interfaces on 210 AMs (air monitors), and covers 11 buildings and more than 5,000 users. This system is based on a previous project, \texttt{MAP} \cite{MAP}, that is a building-wide WLAN monitoring system. The \texttt{MAP} project was more focused on a security WLAN monitoring system and covered a small area of the campus, the computer-science department building, with 20 Aruba AP70\footnote{Aruba Networks, http://www.arubanetworks.com} flashed with \texttt{OpenWrt} Linux \cite{openwrt}. \texttt{DIST} is aimed to cover a larger area. Thanks to more than 1,300 Aruba AP70 access points that provide \texttt{802.11a/b/g} connectivity, the area covered is about 4.6 square kilometers and is populated by over 6,000 students and 2,500 faculty and staff. The whole system is based on the \textit{client/server} mode. It uses sniffers programs that run on the AMs to capture and forward the traffic to team's servers via the campus network. Security was added to the monitoring system because it carries a lot of sensitive information about users of the network such as their \texttt{MAC} addresses that may identify them and their current location. Therefore, all the data exchanged between the AMs and the servers are encrypted to ensure data confidentiality. Authenticity and integrity as also been implemented using \texttt{HMAC-SHA256}. To evaluate the performance of \texttt{DIST}, they monitored the Dartmouth's production wireless network for 62 days straight and analyzed the data collected. Some interesting observations where made like the fact that the variation of active users followed a diurnal pattern or that the ratio between active APs and live APs was low (even at peak time, only about 60 percent of APs were actively used).

 In our own monitoring tool implementation we have reused the idea of client/server mode. Indeed, among our gathering modules we also have sniffers flashed with \texttt{OpenWrt} Linux that capture and collect information about the current network state. They insert those data into a log file they then forward to our server. Because our tool also handles sensitive data our system relies on data encryption, authenticity and integrity.


\subsection{Monitoring Tools}
Several open-source wireless monitoring tools are available on the market. In this section we introduce and describe four of the most widely used ones.

\subsubsection{MRTG}
The Multi Router Traffic Grapher (\texttt{MRTG}) \cite{mrtg} is a tool that monitors the traffic load on network links. It generates HTML pages containing PNG images that provides a live visual representation of this traffic. \texttt{MRTG} is a \texttt{Perl} script that uses \texttt{SNMP} to poll routers and reads traffic counters, or any other \texttt{SNMP} variable, and logs the traffic data in order to create graphs representing the traffic on those monitored network connections. This tool provides detailed daily news as well as representation of the traffic during the last seven days, the last five weeks and the last twelve months. Plus, external programs can gather data and then use \texttt{MRTG} to monitor them. \texttt{MRTG} can be extended in order to work with \texttt{RRDtool} \cite{rrdtool} which is a round robin database tool.

There are however some limitations with \texttt{MRTG}. First, this tool creates graphs every five minutes (even if there a hundreds of them), consuming a lot of CPU time. More, the graphs produced are not very customizable and are not dynamic. Since all the graphs are generated within a PNG image each time, available disk space is a big issue to take into account when working with that tool. Finally, \texttt{MRTG} can be really tricky to manage.

\subsubsection{Cacti}
\texttt{Cacti} \cite{cacti} is a web-based network monitoring and graphing tool designed as a complete front-end for \texttt{RRDtool}. \texttt{Cacti} uses information to create graphs and populate them with data in a MySQL database. The information expands over time, but \texttt{Cacti} stores it in such a way as to keep storage requirements extremely low. A user can poll services and graph the resulting data. This tool also features a \texttt{SNMP} support for devices and custom scripts can be easily written to poll any possible network event. \texttt{Cacti} is also much easier to configure than \texttt{MRTG}.

\subsubsection{Nagios}
As explained in \cite{nagios} \texttt{Nagios} is a computer system monitoring, network monitoring and infrastructure monitoring software application. It can monitor an entire IT infrastructure to ensure that systems, applications, services and business processes are functioning properly. One of the interesting features it offers is the possibility to alert technical staff whenever a problem occurs on the infrastructure by giving real-time event notifications via sms or email. Concerning the network monitoring field, this tool can monitor a bunch of network services such as \texttt{SMTP}, \texttt{POP3}, \texttt{HTTP}, \texttt{NNTP}, \texttt{ICMP}, \texttt{SNMP}, \texttt{FTP} and \texttt{SSH}. It also provides graphs for received data and one of the main difference with the other tools is that text files are used rather than databases to store the data.


\section{Towards a Custom WiFi Monitoring Tool}
From the state of the art described above, we can see that there is room for research in the wireless network monitoring and performance analysis area.\\
Since the UCL's infrastructure is rather complex and uses technologies such as Cisco controllers (WiSMs 2), \texttt{RADIUS}, \texttt{LDAP} and \texttt{DHCP} servers it can be quite difficult to track down all the processes that are executed during an authentication request issued by a user who wants to connect to the UCL's wireless network. It is even more difficult to track down a problem that has occurred on that network at a particular moment.

Indeed, the log files produced by the controllers are extremely detailed inducing an arduous and tricky work of decryption for the SGSI whenever the team wants to trace down a particular network problem. Moreover, another issue the SGSI team faces everyday on the Louvain-la-Neuve area is the fact that there are more and more users trying to get a wireless connection on the campus than before. This can be explained by the fact that nowadays, a significant part of students (as well as staff members) does not only come and attend to courses with their own laptop but also bring smartphones and tablets. The problem those new devices arise is that they can be inadvertently configured to automatically connect to a WiFi network (in our case one of the UCL's wireless networks), whenever one is reachable, even if the user is not currently using those devices to surf the web. These unused connections, added to the one already made by all the laptops, can lead to an overload on an access point resulting into bad performances behaviors and lower signal strength, since the user's connection request might be redirected to a farther access point, inducing connectivity or network access problems.


Our implementation and vision for this monitoring tool is based on three milestones. First of all, we gather on our private server all the information about, on one hand, what is happening and, on the other hand, what has happened on the five wireless networks. Once we have collected these two types of raw data, that we qualify as \textit{active logs} and \textit{passive logs}, we store them into our custom database aggregating them and removing useless data, and we analyze them. Finally, we have developed an online platform on which we present the relevant data about the networks states in real time and in a way that is more convenient and understandable for the SGSI team users. Indeed, we display that information using graphs, pie charts and plain text information depending on the variables that are selected by the user.

Throughout this thesis, we discuss the implementation of a custom WiFi monitoring tool for the UCL's network infrastructure that will help the network administrators from the SGSI team to manage the wireless network and identifying possible problems in order to fix them and avoid further disturbances for the end users. 


In a first chapter, we present the working environment and more specifically, the UCL's wireless infrastructure and all the components and protocols we use in our solution. We also give a fully detailed overview of how the WLAN authentication process works within the UCL infrastructure. Two examples are considered to illustrate this process and information about the infrastructure architecture are provided. In another chapter, the architecture of our monitoring tool is described. Application requirements we need to meet and the linkage with the overall infrastructure is also explained. After the architecture part, all the implementation and deployment details are discussed. Finally we analyze all the results gathered by the passive monitoring and the active monitoring processes during the deployment phase. 


The following subsections give a quick overview of the two first milestones.


\subsection{Data gathering}
The first important step in our implementation design is the network's raw data gathering process. Indeed, to work properly our monitoring tool needs to collect all the information available about what is happening and has happened on the UCL's wireless network.

These data come from several heterogeneous sources. For the \textit{active logs} (i.e. real time information), we have developed and implemented a C program that runs on an \texttt{OpenWrt} Linux router. This program uses the \texttt{wpa\_supplicant} control interface to execute a connection loop trying to establish a connection with each one of the five VLANs available on the campus in order to make a complete authentication process and to see if each of those networks is reachable or not. The program also checks if a selected list of services are reachable once connected to the wireless network and it inserts every process' event responses it receives from \texttt{wpa\_supplicant} into a log file that it sends after a specified amount of time to our server. The routers equipped with this program are thus able to send real time information of the different networks' status.

The second kind of information we gather are the \textit{passive logs}. For those data we use log files directly collected from the Cisco controllers. These files contain all the details about the key elements of the network infrastructure which are the \texttt{RADIUS}, \texttt{LDAP} and \texttt{DHCP} servers as well as information about the controller itself (the \texttt{WiSM}).


\subsection{Data analysis}
Once data, either from the controllers or from the routers, is received from the server the analyzing phase can begin.

We have designed and implemented in Python a parser that parses all piece of information from the collected files. Valuable information is then inserted into our custom database and all the unnecessary and useless one are discarded. Doing so, our monitoring tool has all the UCL wireless infrastructure's status and details in hands and can start aggregating them in order to produce a readable and relevant output that is displayed on the online platform.


%The core will be responsible to centralized, analyse and take the action accordingly the information received from the probes. Its actions will mainly depend on the access that it will have the network. Typical action would be to adapt the controller or inform precisely the administrator of the problems detected. Most of the time, there most difficult is not to be aware of the problem but to understand the causes of it.
%The next step is the data analysis. In that phase, our system examines all the logfiles of the server and [TODO]
